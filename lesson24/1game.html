<div>
    <audio id="myAudio" src="drop-it-124014.mp3"></audio>
    <div id="batman_div" class="batman"><img id="batman" src="batman.png" alt="batman"></div>
    <div id="danger2div" class="danger2"><img id="pillar2" class="pillar2" src="inverted_flappy_pillar.jpeg"
            alt="danger2"></div>
    <div id="dangerdiv" class="danger"><img id="pillar" class="pillar" src="pillar.png" alt="danger"></div>
    <div id="wallpaperdiv" class="wallpaper"><img id="wallpaperid" class="wallpaperclass" src="flappybackground.png"
            alt="background"></div>
</div>

<script>
    document.addEventListener('keydown', function (event) {
        console.log(event.key)

        const myAudio = document.getElementById("myAudio");
        myAudio.play();

        if (true === sprite_crashed()) {
            event.preventDefault();
            return 'game over ðŸ˜­ '
        }

        if (event.key === 'ArrowRight') {
            move('right');
        } else if (event.key === 'ArrowLeft') {
            move('left');
        } else if (event.key === 'ArrowUp') {
            move('up');
        } else if (event.key === 'ArrowDown') {
            move('down');
        }

        event.preventDefault();
    })

    function move(dir) {
        const div = document.getElementById("batman_div")
        const style = getComputedStyle(div)
        const leftStr = style.getPropertyValue('left')
        const topStr = style.getPropertyValue('top')
        const left = parseInt(leftStr, 10)
        const top = parseInt(topStr, 10)
        console.log(left)
        if (dir === 'left')
            document.getElementById("batman_div").style.left = (left - 10) + "px"
        else if (dir === 'right')
            document.getElementById("batman_div").style.left = (left + 10) + "px"
        else if (dir === 'up')
            document.getElementById("batman_div").style.top = (top - 10) + "px"
        else
            document.getElementById("batman_div").style.top = (top + 10) + "px"

        isgameOver()
    }

    function hasCrashed(r1, r2, r3) {
        if (r1.x + r1.width >= r2.x && r1.y <= r2.y + r2.height ||
            r1.x + r1.width >= r3.x && r1.y + r1.height <= r3.y) {
            return true
        }
        else {
            return false
        }
    }

    function makeRect(a) {
        return {
            x: parseInt(getComputedStyle(a).getPropertyValue('left')),
            y: parseInt(getComputedStyle(a).getPropertyValue('top')),
            height: parseInt(getComputedStyle(a).getPropertyValue('height')),
            width: parseInt(getComputedStyle(a).getPropertyValue('width'))
        }
    }

    function sprite_crashed() {
        const sprite = document.getElementById('batman_div')
        const pillar = document.getElementById('dangerdiv')
        const pillar2 = document.getElementById('danger2div')
        const batRect = makeRect(sprite)
        const pRect = makeRect(pillar)
        const p2Rect = makeRect(pillar2)

        const h1 = hasCrashed(batRect, pRect, p2Rect)
        return h1
    }

    function play_gameover_animation() {
        console.log('game over')
    }

    function isgameOver() {
        if (true === sprite_crashed()) {
            play_gameover_animation()
        }
    }

    sprite_crashed()

</script>
<style>
    .batman {
        position: absolute;
        left: 0px;
        width: 200px;
        top: 100px;
        opacity: 0.3;
        /* border: 3px solid green; */
    }

    .danger {
        position: absolute;
        top: 400px;
        margin-top: 200px;
        left: 300px;
        width: 200px;
        height: 100%;
        max-width: 100%;
        max-height: 100%;
        opacity: 0.3;
        /* border: 3px solid green; */
    }

    .danger2 {
        position: absolute;
        top: 0px;
        left: 300px;
        width: 200px;
        height: 100%;
        max-width: 100%;
        max-height: 100%;
        opacity: 0.3;
        /* border: 3px solid green; */
    }

    .wallpaperclass {
        position: top;
        width: 100%;
        height: 1000px;
        object-fit: cover;
        background-size: cover;
        border: 3px solid green;
    }
</style>